<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>6.4</version>
    <template_groups>
        <template_group>
            <uuid>7df96b18c230490a9a0a9e2307226338</uuid>
            <name>Templates</name>
        </template_group>
    </template_groups>
    <templates>
        <template>
            <uuid>5d5c662929534d909f38c0f4328c8d39</uuid>
            <template>OSPF-SNMP</template>
            <name>OSPF-SNMP</name>
            <description>OSPF SNMP neighbors template</description>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>7f233308f7c14c92aa15a723690f8968</uuid>
                    <name>OSPF router admin status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.2.1.14.1.2.0</snmp_oid>
                    <key>ospfAdminStat</key>
                    <delay>4m</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <description>The administrative status of OSPF in the router.</description>
                    <valuemap>
                        <name>ospfAdminStat</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>4h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>OSPF</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>601b0970b5364c1b96600492f7a229e2</uuid>
                            <expression>last(/OSPF-SNMP/ospfAdminStat)&lt;&gt;1</expression>
                            <name>OSPF process is down</name>
                            <priority>HIGH</priority>
                            <description>The administrative status of the OSPF process is not in the enabled state.</description>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>availability</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>788fd15111044a6cbb172bd4dc2de8d9</uuid>
                    <name>OSPF router id</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.2.1.14.1.1.0</snmp_oid>
                    <key>ospfRouterId</key>
                    <delay>1h</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>A 32-bit integer uniquely identifying the router in the Autonomous System.</description>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>4h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>OSPF</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>05874e79afa24ca497ac29b92c324add</uuid>
                    <name>OSPF version</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.2.1.14.1.3.0</snmp_oid>
                    <key>ospfVersionNumber</key>
                    <delay>1h</delay>
                    <history>30d</history>
                    <description>The current version number of the OSPF protocol.</description>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>4h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>OSPF</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>de0038c712f8447ca11192b5b6a8d30e</uuid>
                            <expression>(last(/OSPF-SNMP/ospfVersionNumber,#1)&lt;&gt;last(/OSPF-SNMP/ospfVersionNumber,#2))=1</expression>
                            <name>OSPF version has changed</name>
                            <opdata>Current version: {ITEM.LASTVALUE}</opdata>
                            <priority>AVERAGE</priority>
                            <description>The OSPF version has changed.</description>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>availability</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <uuid>f7475e07d21c408a97ab468945df3680</uuid>
                    <name>OSPF area discovery</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#OSPF_AREA_ID},1.3.6.1.2.1.14.2.1.1]</snmp_oid>
                    <key>ospf.area.discovery</key>
                    <delay>1h</delay>
                    <description>Discover a 32-bit integer uniquely identifying an area.</description>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>465f25cd80f44f3a92625650dd3b706a</uuid>
                            <name>OSPF area {#OSPF_AREA_ID} status</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.14.2.1.10.{#SNMPINDEX}</snmp_oid>
                            <key>ospfAreaStatus[{#SNMPINDEX}]</key>
                            <delay>4m</delay>
                            <history>30d</history>
                            <description>This variable displays the status of the entry.</description>
                            <valuemap>
                                <name>ospfAreaStatus</name>
                            </valuemap>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>OSPF</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>f5a226422c6c4e6090d7dc6506505a2b</uuid>
                                    <expression>last(/OSPF-SNMP/ospfAreaStatus[{#SNMPINDEX}])&lt;&gt;1</expression>
                                    <name>OSPF area {#OSPF_AREA_ID} is down</name>
                                    <priority>HIGH</priority>
                                    <description>OSPF area {#OSPF_AREA_ID} is down.</description>
                                    <tags>
                                        <tag>
                                            <tag>scope</tag>
                                            <value>availability</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>4h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>dbede15c87104201879067cd19d487cb</uuid>
                    <name>OSPF interface discovery</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#OSPF_INTERFACE},1.3.6.1.2.1.14.7.1.1]</snmp_oid>
                    <key>ospf.if.discovery</key>
                    <delay>1h</delay>
                    <description>Discover the IP address of this OSPF interface.</description>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>774a098be3514b1da914d3e86643dbde</uuid>
                            <name>OSPF interface {#OSPF_INTERFACE} admin status</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.14.7.1.5.{#SNMPINDEX}</snmp_oid>
                            <key>ospfIfAdminStat[{#SNMPINDEX}]</key>
                            <delay>4m</delay>
                            <history>30d</history>
                            <description>The OSPF interface's administrative status.</description>
                            <valuemap>
                                <name>ospfIfAdminStat</name>
                            </valuemap>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>OSPF</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>dbe2b0c5fae14e02a4ff7c70e8b7edca</uuid>
                                    <expression>last(/OSPF-SNMP/ospfIfAdminStat[{#SNMPINDEX}])&lt;&gt;1</expression>
                                    <name>OSPF interface {#OSFP_INTERFACE} is administratively down</name>
                                    <priority>WARNING</priority>
                                    <description>OSPF interface {#OSPF_INTERFACE} has administrative status disabled.</description>
                                    <tags>
                                        <tag>
                                            <tag>scope</tag>
                                            <value>availability</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>4h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>ee58d6bbf6e3471aaa2462dc2e966e9f</uuid>
                    <name>OSPF neighbor discovery</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#OSPF_NEIGHBOR},1.3.6.1.4.1.4874.2.2.14.1.10.1.1]</snmp_oid>
                    <key>ospf.neighbor.discovery</key>
                    <delay>1h</delay>
                    <description>Discover the IP address of this neighbor.</description>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>ee566f588ab44f40b569f18f4c49e0ba</uuid>
                            <name>OSPF neighbor {#OSPF_NEIGHBOR} relationship state</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.14.10.1.6.{#SNMPINDEX}</snmp_oid>
                            <key>ospfNbrState[{#SNMPINDEX}]</key>
                            <delay>4m</delay>
                            <history>30d</history>
                            <description>The State of the relationship with this Neighbor.</description>
                            <valuemap>
                                <name>ospfNbrState</name>
                            </valuemap>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>OSPF</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>71736f4af6d547aa9b2d43acf386a49c</uuid>
                                    <expression>last(/OSPF-SNMP/ospfNbrState[{#SNMPINDEX}])&lt;&gt;8</expression>
                                    <name>OSPF neighbor {#OSPF_NEIGHBOR} is down</name>
                                    <opdata>Current state: {ITEM.LASTVALUE}</opdata>
                                    <priority>HIGH</priority>
                                    <description>OSPF neighbor with router ID {#OSPF_NEIGHBOR} is not in operational state full.</description>
                                    <tags>
                                        <tag>
                                            <tag>scope</tag>
                                            <value>availability</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <preprocessing>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>4h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
            </discovery_rules>
            <tags>
                <tag>
                    <tag>class</tag>
                    <value>network</value>
                </tag>
            </tags>
            <valuemaps>
                <valuemap>
                    <uuid>79b92d2debef41918320055812de73f8</uuid>
                    <name>ospfAdminStat</name>
                    <mappings>
                        <mapping>
                            <value>1</value>
                            <newvalue>Enabled</newvalue>
                        </mapping>
                        <mapping>
                            <value>2</value>
                            <newvalue>Disabled</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
                <valuemap>
                    <uuid>2565e816165f4670bbce2e6d696e6369</uuid>
                    <name>ospfAreaStatus</name>
                    <mappings>
                        <mapping>
                            <value>1</value>
                            <newvalue>Enabled</newvalue>
                        </mapping>
                        <mapping>
                            <value>2</value>
                            <newvalue>Disabled</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
                <valuemap>
                    <uuid>db4c7f99d3164b02ae62ac3bd6553e6c</uuid>
                    <name>ospfIfAdminStat</name>
                    <mappings>
                        <mapping>
                            <value>1</value>
                            <newvalue>Enabled</newvalue>
                        </mapping>
                        <mapping>
                            <value>2</value>
                            <newvalue>Disabled</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
                <valuemap>
                    <uuid>91bdcc8a8c494abcbe98e5cb6d6a0689</uuid>
                    <name>ospfNbrState</name>
                    <mappings>
                        <mapping>
                            <value>1</value>
                            <newvalue>down</newvalue>
                        </mapping>
                        <mapping>
                            <value>2</value>
                            <newvalue>attempt</newvalue>
                        </mapping>
                        <mapping>
                            <value>3</value>
                            <newvalue>init</newvalue>
                        </mapping>
                        <mapping>
                            <value>4</value>
                            <newvalue>twoWay</newvalue>
                        </mapping>
                        <mapping>
                            <value>5</value>
                            <newvalue>exchangeStart</newvalue>
                        </mapping>
                        <mapping>
                            <value>6</value>
                            <newvalue>exchange</newvalue>
                        </mapping>
                        <mapping>
                            <value>7</value>
                            <newvalue>loading</newvalue>
                        </mapping>
                        <mapping>
                            <value>8</value>
                            <newvalue>full</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
            </valuemaps>
        </template>
    </templates>
</zabbix_export>
